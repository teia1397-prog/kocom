uart:
  id: uart_bus
  baud_rate: 9600
  data_bits: 8
  parity: NONE
  stop_bits: 1
  rx_pin: GPIO01
  tx_pin: GPIO02
  debug:
    direction: BOTH
    dummy_receiver: false
    after:
      delimiter: [0x0D, 0x0D]
    sequence:
      - lambda: |-
          ESP_LOGI("uart_debug", "Direction: %s, Bytes: %s", 
            direction == uart::UART_DIRECTION_RX ? "RX" : "TX",
            format_hex_pretty(bytes).c_str());

external_components:
  - source: github://eigger/espcomponents@latest
    components: [uartex]
    refresh: always

uartex:
  rx_timeout: 10ms
  tx_delay: 50ms
  tx_timeout: 500ms
  tx_retry_cnt: 3

  rx_header: [0xAA, 0x55]
  rx_footer: [0x0D, 0x0D]
  tx_header: [0xAA, 0x55]
  tx_footer: [0x0D, 0x0D]

  rx_checksum: add_no_header
  tx_checksum: add_no_header

  version:
    disabled: False
  error:
    disabled: False
  log:
    disabled: False

# ë¡œê·¸ ì„¤ì • - ë””ë²„ê¹…ìš©
logger:
  level: DEBUG
  logs:
    uart_debug: DEBUG
    uartex: DEBUG

light:
  # ê±°ì‹¤ ì¡°ëª… (Room 0) - ë‹¨ì¼ ì¡°ëª…
  - platform: uartex
    name: "Living Room Light"
    id: living_room_light
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì•ˆë°© ì¡°ëª… 1 (Room 1)
  - platform: uartex
    name: "Master Bedroom Light 1"
    id: master_bedroom_light_1
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x01]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì•ˆë°© ì¡°ëª… 2 (Room 1)
  - platform: uartex
    name: "Master Bedroom Light 2"
    id: master_bedroom_light_2
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x01]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì•ˆë°©í™”ì¥ì‹¤ ì¡°ëª… 1 (Room 2)
  - platform: uartex
    name: "Master Bathroom Light 1"
    id: master_bathroom_light_1
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì•ˆë°©í™”ì¥ì‹¤ ì¡°ëª… 2 (Room 2)
  - platform: uartex
    name: "Master Bathroom Light 2"
    id: master_bathroom_light_2
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì•ˆë°©í™”ì¥ì‹¤ ì¡°ëª… 3 (Room 2)
  - platform: uartex
    name: "Master Bathroom Light 3"
    id: master_bathroom_light_3
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 10
      data: [0xff]
    state_off:
      offset: 10
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì•„ì´ë°© ì¡°ëª… (Room 3)
  - platform: uartex
    name: "Kids Room Light"
    id: kids_room_light
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x03]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x03, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì˜·ë°© ì¡°ëª… (Room 4)
  - platform: uartex
    name: "Dressing Room Light"
    id: dressing_room_light
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x04]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x04, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ê±°ì‹¤í™”ì¥ì‹¤ ì¡°ëª… 1 (Room 5)
  - platform: uartex
    name: "Guest Bathroom Light 1"
    id: guest_bathroom_light_1
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x05]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ê±°ì‹¤í™”ì¥ì‹¤ ì¡°ëª… 2 (Room 5)
  - platform: uartex
    name: "Guest Bathroom Light 2"
    id: guest_bathroom_light_2
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x05]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì£¼ë°© ì¡°ëª… (Room 6)
  - platform: uartex
    name: "Kitchen Light 1"
    id: kitchen_light_1
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x06]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x06, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  - platform: uartex
    name: "Kitchen Light 2"
    id: kitchen_light_2
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x06]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x06, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

switch:
  # ê±°ì‹¤í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ (Room 5) - ì¡°ëª…ê³¼ ê°™ì€ ë””ë°”ì´ìŠ¤ì§€ë§Œ ë‹¤ë¥¸ offset ì‚¬ìš©
  - platform: template
    name: "Guest Bathroom Ventilation"
    id: guest_bathroom_ventilation
    optimistic: true
    restore_mode: DISABLED
    turn_on_action:
      # í˜„ì¬ ì¡°ëª… ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ í™˜ê¸°íŒ¬ë§Œ ì¼œê¸°
      - if:
          condition:
            light.is_on: guest_bathroom_light_1
          then:
            - if:
                condition:
                  light.is_on: guest_bathroom_light_2
                then:
                  # ì¡°ëª… 1,2 ëª¨ë‘ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
                else:
                  # ì¡°ëª… 1ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0xff, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
          else:
            - if:
                condition:
                  light.is_on: guest_bathroom_light_2
                then:
                  # ì¡°ëª… 2ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
                else:
                  # ì¡°ëª… ëª¨ë‘ êº¼ì ¸ìˆìŒ + í™˜ê¸°íŒ¬ë§Œ ì¼œê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
      - logger.log: "ê±°ì‹¤í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ ì¼œì§ (ì¡°ëª… ìƒíƒœ ìœ ì§€)"
    turn_off_action:
      # í˜„ì¬ ì¡°ëª… ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ í™˜ê¸°íŒ¬ë§Œ ë„ê¸°
      - if:
          condition:
            light.is_on: guest_bathroom_light_1
          then:
            - if:
                condition:
                  light.is_on: guest_bathroom_light_2
                then:
                  # ì¡°ëª… 1,2 ëª¨ë‘ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
                else:
                  # ì¡°ëª… 1ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
          else:
            - if:
                condition:
                  light.is_on: guest_bathroom_light_2
                then:
                  # ì¡°ëª… 2ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
                else:
                  # ì¡°ëª… ëª¨ë‘ êº¼ì ¸ìˆìŒ + í™˜ê¸°íŒ¬ë§Œ ë„ê¸°
                  - uartex.write:
                      data:
                        [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
                      ack: [0x30, 0xdc]
      - logger.log: "ê±°ì‹¤í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ êº¼ì§ (ì¡°ëª… ìƒíƒœ ìœ ì§€)"
    on_turn_on:
      - logger.log: "ê±°ì‹¤í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ ì¼œì§"
    on_turn_off:
      - logger.log: "ê±°ì‹¤í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ êº¼ì§"

  # ì•ˆë°©í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ (Room 2) - ì¡°ëª…ê³¼ ê°™ì€ ë””ë°”ì´ìŠ¤ì§€ë§Œ ë‹¤ë¥¸ offset ì‚¬ìš©
  - platform: template
    name: "Master Bathroom Ventilation"
    id: master_bathroom_ventilation
    optimistic: true
    restore_mode: DISABLED
    turn_on_action:
      # í˜„ì¬ ì¡°ëª… ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ í™˜ê¸°íŒ¬ë§Œ ì¼œê¸°
      - if:
          condition:
            light.is_on: master_bathroom_light_1
          then:
            - if:
                condition:
                  light.is_on: master_bathroom_light_2
                then:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 1,2,3 ëª¨ë‘ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0xff,
                                0xff,
                                0xff,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… 1,2ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0xff,
                                0xff,
                                0x00,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                else:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 1,3ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0xff,
                                0x00,
                                0xff,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… 1ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                        - uartex.write:
                            data:
                              [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00]
                            ack: [0x30, 0xdc]
          else:
            - if:
                condition:
                  light.is_on: master_bathroom_light_2
                then:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 2,3ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0xff,
                                0xff,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… 2ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0xff,
                                0x00,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                else:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 3ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ì¼œê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0xff,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… ëª¨ë‘ êº¼ì ¸ìˆìŒ + í™˜ê¸°íŒ¬ë§Œ ì¼œê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
      - logger.log: "ì•ˆë°©í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ ì¼œì§ (ì¡°ëª… ìƒíƒœ ìœ ì§€)"
    turn_off_action:
      # í˜„ì¬ ì¡°ëª… ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ í™˜ê¸°íŒ¬ë§Œ ë„ê¸°
      - if:
          condition:
            light.is_on: master_bathroom_light_1
          then:
            - if:
                condition:
                  light.is_on: master_bathroom_light_2
                then:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 1,2,3 ëª¨ë‘ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0xff,
                                0xff,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… 1,2ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0xff,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                else:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 1,3ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0xff,
                                0x00,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… 1ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
          else:
            - if:
                condition:
                  light.is_on: master_bathroom_light_2
                then:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 2,3ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0xff,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… 2ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                else:
                  - if:
                      condition:
                        light.is_on: master_bathroom_light_3
                      then:
                        # ì¡°ëª… 3ë§Œ ì¼œì ¸ìˆìŒ + í™˜ê¸°íŒ¬ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0xff,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
                      else:
                        # ì¡°ëª… ëª¨ë‘ êº¼ì ¸ìˆìŒ + í™˜ê¸°íŒ¬ë§Œ ë„ê¸°
                        - uartex.write:
                            data:
                              [
                                0x30,
                                0xbc,
                                0x00,
                                0x0e,
                                0x02,
                                0x01,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                                0x00,
                              ]
                            ack: [0x30, 0xdc]
      - logger.log: "ì•ˆë°©í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ êº¼ì§ (ì¡°ëª… ìƒíƒœ ìœ ì§€)"
    on_turn_on:
      - logger.log: "ì•ˆë°©í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ ì¼œì§"
    on_turn_off:
      - logger.log: "ì•ˆë°©í™”ì¥ì‹¤ í™˜ê¸°íŒ¬ êº¼ì§"

  # ê±°ì‹¤ ì „ì²´ í™˜í’ê¸° (Room 0) - 0x48 ë””ë°”ì´ìŠ¤ ì‚¬ìš©
  - platform: uartex
    name: "Living Room Ventilation"
    id: living_room_ventilation
    state:
      data: [0x30, 0xdc, 0x00, 0x48, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 12
      data: [0x40]
    state_off:
      offset: 12
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x48, 0x00, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x48, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    on_turn_on:
      - logger.log: "ê±°ì‹¤ ì „ì²´ í™˜í’ê¸° ì¼œì§ (0x48 ë””ë°”ì´ìŠ¤)"
    on_turn_off:
      - logger.log: "ê±°ì‹¤ ì „ì²´ í™˜í’ê¸° êº¼ì§ (0x48 ë””ë°”ì´ìŠ¤)"

climate:
  # ê±°ì‹¤ ë‚œë°© (Room 0) - í”„ë¦¬ì…‹ ëª¨ë“œë¡œë§Œ ì œì–´ (ì „ì› ë²„íŠ¼ ì—†ìŒ)
  - platform: uartex
    name: "Living Room Heater"
    id: living_room_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11] # ë‚œë°© ìƒíƒœ (0x11ë§Œ ì²´í¬)
    state_off:
      offset: 8
      data: [0x00] # êº¼ì§„ ìƒíƒœ
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_heat: !lambda |-
      uint8_t target = id(living_room_heater).target_temperature;
      uint8_t preset = id(living_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(living_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(living_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(living_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ê±°ì‹¤ ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'

  # ì•ˆë°© ë‚œë°© (Room 1) - í”„ë¦¬ì…‹ ëª¨ë“œë¡œë§Œ ì œì–´ (ì „ì› ë²„íŠ¼ ì—†ìŒ)
  - platform: uartex
    name: "Master Bedroom Heater"
    id: master_bedroom_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x01]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11] # ë‚œë°© ìƒíƒœ (0x11ë§Œ ì²´í¬)
    state_off:
      offset: 8
      data: [0x00] # êº¼ì§„ ìƒíƒœ
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_heat: !lambda |-
      uint8_t target = id(master_bedroom_heater).target_temperature;
      uint8_t preset = id(master_bedroom_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(master_bedroom_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(master_bedroom_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(master_bedroom_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ì•ˆë°© ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'

  # ì˜·ë°© ë‚œë°© (Room 3) - í”„ë¦¬ì…‹ ëª¨ë“œë¡œë§Œ ì œì–´ (ì „ì› ë²„íŠ¼ ì—†ìŒ)
  - platform: uartex
    name: "Room 2 Heater"
    id: room2_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x03]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11] # ë‚œë°© ìƒíƒœ (0x11ë§Œ ì²´í¬)
    state_off:
      offset: 8
      data: [0x00] # êº¼ì§„ ìƒíƒœ
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_heat: !lambda |-
      uint8_t target = id(room2_heater).target_temperature;
      uint8_t preset = id(room2_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(room2_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(room2_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(room2_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ì˜·ë°© ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'

  # ì—°ìš°ë°© ë‚œë°© (Room 2) - í”„ë¦¬ì…‹ ëª¨ë“œë¡œë§Œ ì œì–´ (ì „ì› ë²„íŠ¼ ì—†ìŒ)
  - platform: uartex
    name: "Room 1 Heater"
    id: room1_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11] # ë‚œë°© ìƒíƒœ (0x11ë§Œ ì²´í¬)
    state_off:
      offset: 8
      data: [0x00] # êº¼ì§„ ìƒíƒœ
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_heat: !lambda |-
      uint8_t target = id(room1_heater).target_temperature;
      uint8_t preset = id(room1_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(room1_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(room1_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(room1_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ì—°ìš°ë°© ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'

binary_sensor:
  # í˜„ê´€ ì´ˆì¸ì¢… ê°ì§€ (ë‹¤ì–‘í•œ íŒ¨í„´ ì‹œë„)
  - platform: uartex
    name: "Doorbell"
    icon: "mdi:doorbell"
    device_class: sound
    state:
      data: [0x30, 0xbc, 0x00, 0x60, 0x00] # ëª¨ì…˜/ë„ì–´ë²¨ ë””ë°”ì´ìŠ¤
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0x01]
    state_off:
      offset: 8
      data: [0x00]
    on_press:
      - logger.log: "ğŸ”” í˜„ê´€ ì´ˆì¸ì¢…ì´ ëˆŒë ¸ìŠµë‹ˆë‹¤!"
    on_release:
      - logger.log: "ğŸ”” í˜„ê´€ ì´ˆì¸ì¢… ì‹ í˜¸ ì¢…ë£Œ"

  # í˜„ê´€ë¬¸ ì—´ë¦¼ ê°ì§€ ì„¼ì„œ
  - platform: uartex
    name: "Front Door"
    icon: "mdi:door"
    device_class: door
    state:
      data: [0x30, 0xd0, 0x00, 0x60, 0x00] # ìƒíƒœ ì¡°íšŒ íŒ¨í„´
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0x00] # ë¬¸ ì—´ë¦¼ (ê°’ ë°˜ì „)
    state_off:
      offset: 8
      data: [0x01] # ë¬¸ ë‹«í˜ (ê°’ ë°˜ì „)
    on_press:
      - logger.log: "ï¿½ í˜„ê´€ë¬¸ì´ ì¢…ì—´ë ¸ìŠµë‹ˆë‹¤!"
    on_release:
      - logger.log: "ğŸšª í˜„ê´€ë¬¸ì´ ë‹«í˜”ìŠµë‹ˆë‹¤!"

button:
  # ì—˜ë¦¬ë² ì´í„° í˜¸ì¶œ
  - platform: uartex
    name: "Elevator Call"
    icon: "mdi:elevator"
    command_on:
      data: [0x30, 0xbc, 0x00, 0x01, 0x00, 0x44, 0x00, 0x01, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  # ì „ì› ê³µê¸‰ì„ ë§Œ í™œì„±í™” (ì¡°ëª…ì€ ì¼œì§€ì§€ ì•ŠìŒ)
  - platform: template
    name: "Power Supply Activate"
    icon: "mdi:power-plug"
    on_press:
      # ì „ì› ê³µê¸‰ì„ ë§Œ í™œì„±í™” - Room IDë¥¼ 0x00ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ì¼ê´„ì†Œë“± ë°©ì§€
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x00, 0x01, 0x00, 0x66, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - logger.log: "ì „ì› ê³µê¸‰ì„  í™œì„±í™” (ì¼ê´„ì†Œë“± ë°©ì§€ ì ìš©)"
