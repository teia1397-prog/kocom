uart:
  id: uart_bus
  baud_rate: 9600
  data_bits: 8
  parity: NONE
  stop_bits: 1
  rx_pin: GPIO01
  tx_pin: GPIO02
  debug:
    direction: BOTH
    dummy_receiver: false
    after:
      delimiter: [0x0D, 0x0D]
    sequence:
      - lambda: |-
          ESP_LOGI("uart_debug", "Direction: %s, Bytes: %s", 
            direction == uart::UART_DIRECTION_RX ? "RX" : "TX",
            format_hex_pretty(bytes).c_str());

external_components:
  - source: github://eigger/espcomponents@latest
    components: [uartex]
    refresh: always
    
uartex:
  rx_timeout: 10ms
  tx_delay: 50ms
  tx_timeout: 500ms
  tx_retry_cnt: 3
  rx_header: [0xAA, 0x55]
  rx_footer: [0x0D, 0x0D]
  tx_header: [0xAA, 0x55]
  tx_footer: [0x0D, 0x0D]
  rx_checksum: add_no_header
  tx_checksum: add_no_header
  version:
    disabled: False
  error:
    disabled: False
  log:
    disabled: False

logger:
  level: DEBUG
  logs:
    uart_debug: DEBUG
    uartex: DEBUG

esphome:
  on_boot:
    priority: -100
    then:
      - delay: 5s
      - logger.log: "ì½”ì½¤ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ"

globals:
  - id: elevator_text_state
    type: std::string
    initial_value: '"ëŒ€ê¸°"'

# ============================================
# ì¡°ëª… (ì›í•˜ëŠ” ìˆœì„œëŒ€ë¡œ ì¬ë°°ì—´)
# ============================================
light:
  # 1. ì•ˆë°© ì¡°ëª… (Room 1)
  - platform: uartex
    name: "ì•ˆë°© ì¡°ëª… 1 (R1)"
    id: master_bedroom_light_1
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x01]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on: !lambda |-
      uint8_t light2_state = id(master_bedroom_light_2).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, 0xff, light2_state, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_off: !lambda |-
      uint8_t light2_state = id(master_bedroom_light_2).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, 0x00, light2_state, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x0e, 0x01, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 120min

  - platform: uartex
    name: "ì•ˆë°© ì¡°ëª… 2 (R1)"
    id: master_bedroom_light_2
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x01]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on: !lambda |-
      uint8_t light1_state = id(master_bedroom_light_1).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, light1_state, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_off: !lambda |-
      uint8_t light1_state = id(master_bedroom_light_1).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, light1_state, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};

  # 2. ì„¸ë‚˜ë°© (Room 2)
  - platform: uartex
    name: "ì„¸ë‚˜ë°© ì¡°ëª… (R2)"
    id: room_2_light
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 123min

  # 3. ì‚¬ë¼ë°© (Room 3)
  - platform: uartex
    name: "ì‚¬ë¼ë°© ì¡°ëª… (R3)"
    id: room_3_light
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x03]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x03, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x0e, 0x03, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 126min

  # 4. ì•ŒíŒŒë£¸ (Room 4)
  - platform: uartex
    name: "ì•ŒíŒŒë£¸ ì¡°ëª… (R4)"
    id: Alpha_room_light
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x04]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x04, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_off:
      data: [0x30, 0xbc, 0x00, 0x0e, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x0e, 0x04, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 129min

  # 5. ê±°ì‹¤ ì¡°ëª… (Room 0)
  - platform: uartex
    name: "ê±°ì‹¤ ì¡°ëª… 1 (R0)"
    id: living_room_light_1
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on: !lambda |-
      uint8_t light2_state = id(living_room_light_2).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0xff, light2_state, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_off: !lambda |-
      uint8_t light2_state = id(living_room_light_2).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, light2_state, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x0e, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 141min

  - platform: uartex
    name: "ê±°ì‹¤ ì¡°ëª… 2 (R0)"
    id: living_room_light_2
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on: !lambda |-
      uint8_t light1_state = id(living_room_light_1).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, light1_state, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_off: !lambda |-
      uint8_t light1_state = id(living_room_light_1).current_values.is_on() ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, light1_state, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};

  # 6. ì£¼ë°© ì¡°ëª… (Room 5)
  - platform: uartex
    name: "ì£¼ë°© ì¡°ëª… 1 (R5)"
    id: kitchen_light_1
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x05]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on: !lambda |-
      uint8_t l2 = id(kitchen_light_2).current_values.is_on() ? 0xff : 0x00;
      uint8_t l3 = id(kitchen_light_3).current_values.is_on() ? 0xff : 0x00;
      return {{0x30,0xbc,0x00,0x0e,0x05,0x00,0x00,0x00,0xff,l2,l3,0x00,0x00,0x00,0x00,0x00},{0x30,0xdc}};
    command_off: !lambda |-
      uint8_t l2 = id(kitchen_light_2).current_values.is_on() ? 0xff : 0x00;
      uint8_t l3 = id(kitchen_light_3).current_values.is_on() ? 0xff : 0x00;
      return {{0x30,0xbc,0x00,0x0e,0x05,0x00,0x00,0x00,0x00,l2,l3,0x00,0x00,0x00,0x00,0x00},{0x30,0xdc}};
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 132min

  - platform: uartex
    name: "ì£¼ë°© ì¡°ëª… 2 (R5)"
    id: kitchen_light_2
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x05]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on: !lambda |-
      uint8_t l1 = id(kitchen_light_1).current_values.is_on() ? 0xff : 0x00;
      uint8_t l3 = id(kitchen_light_3).current_values.is_on() ? 0xff : 0x00;
      return {{0x30,0xbc,0x00,0x0e,0x05,0x00,0x00,0x00,l1,0xff,l3,0x00,0x00,0x00,0x00,0x00},{0x30,0xdc}};
    command_off: !lambda |-
      uint8_t l1 = id(kitchen_light_1).current_values.is_on() ? 0xff : 0x00;
      uint8_t l3 = id(kitchen_light_3).current_values.is_on() ? 0xff : 0x00;
      return {{0x30,0xbc,0x00,0x0e,0x05,0x00,0x00,0x00,l1,0x00,l3,0x00,0x00,0x00,0x00,0x00},{0x30,0xdc}};

  - platform: uartex
    name: "ì£¼ë°© ì¡°ëª… 3 (R5)"
    id: kitchen_light_3
    state:
      data: [0x30, 0xd0, 0x00, 0x0e, 0x05]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 10
      data: [0xff]
    state_off:
      offset: 10
      data: [0x00]
    command_on: !lambda |-
      uint8_t l1 = id(kitchen_light_1).current_values.is_on() ? 0xff : 0x00;
      uint8_t l2 = id(kitchen_light_2).current_values.is_on() ? 0xff : 0x00;
      return {{0x30,0xbc,0x00,0x0e,0x05,0x00,0x00,0x00,l1,l2,0xff,0x00,0x00,0x00,0x00,0x00},{0x30,0xdc}};
    command_off: !lambda |-
      uint8_t l1 = id(kitchen_light_1).current_values.is_on() ? 0xff : 0x00;
      uint8_t l2 = id(kitchen_light_2).current_values.is_on() ? 0xff : 0x00;
      return {{0x30,0xbc,0x00,0x0e,0x05,0x00,0x00,0x00,l1,l2,0x00,0x00,0x00,0x00,0x00,0x00},{0x30,0xdc}};

# ============================================
# ë³´ì¼ëŸ¬ (ì›í•˜ëŠ” ìˆœì„œëŒ€ë¡œ ì¬ë°°ì—´)
# ============================================
climate:
  # 1. ì•ˆë°© ë³´ì¼ëŸ¬ (Room 1)
  - platform: uartex
    name: "ì•ˆë°© ë³´ì¼ëŸ¬ (R1)"
    id: master_room_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x01]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11]
    state_off:
      offset: 8
      data: [0x00]
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_off: !lambda |-
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc, 0x00, 0x36, 0x00}};
    command_heat: !lambda |-
      uint8_t target = id(master_room_heater).target_temperature;
      uint8_t preset = id(master_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(master_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(master_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(master_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ì•ˆë°© ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 2h

  # 2. ì„¸ë‚˜ë°© ë³´ì¼ëŸ¬ (Room 2)
  - platform: uartex
    name: "ì„¸ë‚˜ë°© ë³´ì¼ëŸ¬ (R2)"
    id: room2_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11]
    state_off:
      offset: 8
      data: [0x00]
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_off: !lambda |-
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc, 0x00, 0x36, 0x00}};
    command_heat: !lambda |-
      uint8_t target = id(room2_heater).target_temperature;
      uint8_t preset = id(room2_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(room2_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(room2_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(room2_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ì„¸ë‚˜ë°© ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 2h

  # 3. ì‚¬ë¼ë°© ë³´ì¼ëŸ¬ (Room 3)
  - platform: uartex
    name: "ì‚¬ë¼ë°© ë³´ì¼ëŸ¬ (R3)"
    id: room3_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x03]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11]
    state_off:
      offset: 8
      data: [0x00]
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_off: !lambda |-
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc, 0x00, 0x36, 0x00}};
    command_heat: !lambda |-
      uint8_t target = id(room3_heater).target_temperature;
      uint8_t preset = id(room3_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(room3_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(room3_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(room3_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ì‚¬ë¼ë°© ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 2h

  # 4. ì•ŒíŒŒë£¸ ë³´ì¼ëŸ¬ (Room 4)
  - platform: uartex
    name: "ì•ŒíŒŒë£¸ ë³´ì¼ëŸ¬ (R4)"
    id: Alpha_room_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x04]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11]
    state_off:
      offset: 8
      data: [0x00]
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_off: !lambda |-
      return {{0x30, 0xbc, 0x00, 0x36, 0x04, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc, 0x00, 0x36, 0x00}};
    command_heat: !lambda |-
      uint8_t target = id(Alpha_room_heater).target_temperature;
      uint8_t preset = id(Alpha_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x04, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(Alpha_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x04, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(Alpha_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x04, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(Alpha_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x04, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ì•ŒíŒŒë£¸ ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x36, 0x04, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 2h

  # 5. ê±°ì‹¤ ë³´ì¼ëŸ¬ (Room 0)
  - platform: uartex
    name: "ê±°ì‹¤ ë³´ì¼ëŸ¬ (R0)"
    id: living_room_heater
    visual:
      min_temperature: 10 Â°C
      max_temperature: 30 Â°C
      temperature_step: 1 Â°C
    state:
      data: [0x30, 0xd0, 0x00, 0x36, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_temperature_current:
      offset: 12
      length: 1
      precision: 0
    state_temperature_target:
      offset: 10
      length: 1
      precision: 0
    state_heat:
      offset: 8
      data: [0x11]
    state_off:
      offset: 8
      data: [0x00]
    state_preset_away:
      offset: 9
      data: [0x01]
    state_preset_none:
      offset: 9
      data: [0x00]
    command_off: !lambda |-
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc, 0x00, 0x36, 0x00}};
    command_heat: !lambda |-
      uint8_t target = id(living_room_heater).target_temperature;
      uint8_t preset = id(living_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_none: !lambda |-
      uint8_t target = id(living_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, 0x00, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_preset_away: !lambda |-
      uint8_t target = id(living_room_heater).target_temperature;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, 0x01, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_temperature: !lambda |-
      uint8_t target = x;
      uint8_t preset = id(living_room_heater).preset == climate::CLIMATE_PRESET_AWAY ? 0x01 : 0x00;
      return {{0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x00, 0x11, preset, target, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    on_state:
      - logger.log:
          format: "ê±°ì‹¤ ë³´ì¼ëŸ¬ ìƒíƒœ ë³€ê²½: ëª¨ë“œ=%s, ëª©í‘œì˜¨ë„=%.0fÂ°C, í˜„ì¬ì˜¨ë„=%.0fÂ°C, í”„ë¦¬ì…‹=%s"
          args:
            - 'x.mode == CLIMATE_MODE_HEAT ? "ë‚œë°©" : x.mode == CLIMATE_MODE_OFF ? "êº¼ì§" : "ì•Œìˆ˜ì—†ìŒ"'
            - "x.target_temperature"
            - "x.current_temperature"
            - 'x.preset == CLIMATE_PRESET_AWAY ? "ì™¸ì¶œ" : "ì¼ë°˜"'
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 2h

# ============================================
# ê¸°íƒ€ ì¥ì¹˜ë“¤
# ============================================
binary_sensor:
  - platform: uartex
    name: "Doorbell"
    icon: "mdi:doorbell"
    device_class: sound
    state:
      data: [0x30, 0xbc, 0x00, 0x60, 0x00]
      mask: [0xff, 0xff, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0x01]
    state_off:
      offset: 8
      data: [0x00]
    on_press:
      - logger.log: "ğŸ”” í˜„ê´€ ì´ˆì¸ì¢…ì´ ëˆŒë ¸ìŠµë‹ˆë‹¤!"
    on_release:
      - logger.log: "ğŸ”” í˜„ê´€ ì´ˆì¸ì¢… ì‹ í˜¸ ì¢…ë£Œ"

  - platform: uartex
    name: "Front Door"
    icon: "mdi:door"
    device_class: door
    state:
      data: [0x30, 0xd0, 0x00, 0x60, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0x01]
    state_off:
      offset: 8
      data: [0x00]
    on_press:
      - logger.log: "ğŸšª í˜„ê´€ë¬¸ì´ ì—´ë ¸ìŠµë‹ˆë‹¤!"
    on_release:
      - logger.log: "ğŸšª í˜„ê´€ë¬¸ì´ ë‹«í˜”ìŠµë‹ˆë‹¤!"

  - platform: uartex
    internal: true
    id: elevator_raw
    state:
      data: [0x30, 0xb0, 0x00, 0x44, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0x03]
    on_press:
      then:
        - lambda: 'id(elevator_text_state) = "ë„ì°©";'
        - component.update: elevator_display_sensor
        - delay: 10s
        - lambda: 'id(elevator_text_state) = "ëŒ€ê¸°";'
        - component.update: elevator_display_sensor

text_sensor:
  - platform: template
    name: "Elevator Status"
    id: elevator_display_sensor
    icon: mdi:elevator
    lambda: |-
      return id(elevator_text_state);

button:
  - platform: uartex
    name: "Elevator Call"
    icon: "mdi:elevator"
    command_on:
      data: [0x30, 0xbc, 0x00, 0x01, 0x00, 0x44, 0x00, 0x01, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]

  - platform: template
    name: "Power Supply Activate"
    icon: "mdi:power-plug"
    on_press:
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x00, 0x01, 0x00, 0x66, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - logger.log: "ì „ì› ê³µê¸‰ì„  í™œì„±í™” (ì¼ê´„ì†Œë“± ë°©ì§€ ì ìš©)"

valve:
  - platform: uartex
    name: "Gas Valve"
    state: 
      data: [0x30, 0xd0, 0x00, 0x2c, 0x00]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_open:
      offset: 7
      data: [0x01]
    state_closed:
      offset: 7
      data: [0x01]
      inverted: true
    command_close:
      data: [0x30, 0xbc, 0x00, 0x2c, 0x00, 0x01, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    command_update: 
      data: [0x30, 0xbc, 0x00, 0x2c, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 2h

switch:
  - platform: template
    name: "All Lights Control"
    icon: "mdi:lightbulb-group"
    optimistic: false
    restore_mode: DISABLED
    turn_on_action:
      - logger.log: "ì¼ê´„ì†Œë“± í•´ì œ ì‹œë„ ì¤‘..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x01, 0x00, 0x3b, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 100ms
      - lambda: 'id(all_lights_control).publish_state(true);'
      - logger.log: "ì¼ê´„ì†Œë“± í•´ì œ ì™„ë£Œ"
    turn_off_action:
      - logger.log: "ì¼ê´„ì†Œë“± ì‹¤í–‰ ì¤‘..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x3b, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 100ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x01, 0x00, 0x3b, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 100ms
      - lambda: 'id(all_lights_control).publish_state(false);'
      - logger.log: "ì¼ê´„ì†Œë“± ì™„ë£Œ"
    id: all_lights_control

# ============================================
# ì½˜ì„¼íŠ¸ ì œì–´ (ì„¸ë‚˜ë°© ì˜ˆì‹œ)
# ============================================

  
  # ì„¸ë‚˜ë°© ì½˜ì„¼íŠ¸ 1
  - platform: uartex
    name: "ì„¸ë‚˜ë°© ì½˜ì„¼íŠ¸ 1"
    id: room2_outlet_1
    icon: "mdi:power-socket-de"
    state:
      data: [0x30, 0xd0, 0x00, 0x3b, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 8
      data: [0xff]
    state_off:
      offset: 8
      data: [0x00]
    command_on: !lambda |-
      uint8_t out2 = id(room2_outlet_2).state ? 0xff : 0x00;
      uint8_t out3 = id(room2_outlet_3).state ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x3b, 0x02, 0x01, 0x00, 0x00, 0xff, out2, out3, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_off: !lambda |-
      uint8_t out2 = id(room2_outlet_2).state ? 0xff : 0x00;
      uint8_t out3 = id(room2_outlet_3).state ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x3b, 0x02, 0x01, 0x00, 0x00, 0x00, out2, out3, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_update:
      data: [0x30, 0xbc, 0x00, 0x3b, 0x02, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
      ack: [0x30, 0xdc]
    update_interval: 2h

  # ì„¸ë‚˜ë°© ì½˜ì„¼íŠ¸ 2
  - platform: uartex
    name: "ì„¸ë‚˜ë°© ì½˜ì„¼íŠ¸ 2"
    id: room2_outlet_2
    icon: "mdi:power-socket-de"
    state:
      data: [0x30, 0xd0, 0x00, 0x3b, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 9
      data: [0xff]
    state_off:
      offset: 9
      data: [0x00]
    command_on: !lambda |-
      uint8_t out1 = id(room2_outlet_1).state ? 0xff : 0x00;
      uint8_t out3 = id(room2_outlet_3).state ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x3b, 0x02, 0x01, 0x00, 0x00, out1, 0xff, out3, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_off: !lambda |-
      uint8_t out1 = id(room2_outlet_1).state ? 0xff : 0x00;
      uint8_t out3 = id(room2_outlet_3).state ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x3b, 0x02, 0x01, 0x00, 0x00, out1, 0x00, out3, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};

  # ì„¸ë‚˜ë°© ì½˜ì„¼íŠ¸ 3
  - platform: uartex
    name: "ì„¸ë‚˜ë°© ì½˜ì„¼íŠ¸ 3"
    id: room2_outlet_3
    icon: "mdi:power-socket-de"
    state:
      data: [0x30, 0xd0, 0x00, 0x3b, 0x02]
      mask: [0xff, 0xf0, 0xff, 0xff, 0xff]
    state_on:
      offset: 10
      data: [0xff]
    state_off:
      offset: 10
      data: [0x00]
    command_on: !lambda |-
      uint8_t out1 = id(room2_outlet_1).state ? 0xff : 0x00;
      uint8_t out2 = id(room2_outlet_2).state ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x3b, 0x02, 0x01, 0x00, 0x00, out1, out2, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};
    command_off: !lambda |-
      uint8_t out1 = id(room2_outlet_1).state ? 0xff : 0x00;
      uint8_t out2 = id(room2_outlet_2).state ? 0xff : 0x00;
      return {{0x30, 0xbc, 0x00, 0x3b, 0x02, 0x01, 0x00, 0x00, out1, out2, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},{0x30, 0xdc}};

 #      í•µì‹¬ í¬ì¸íŠ¸:

 #íŒ¨í‚· êµ¬ì¡°: 0x30, 0xbc, 0x00, 0x3b, 0x02 (ì„¸ë‚˜ë°© ì½˜ì„¼íŠ¸ ì œì–´)
 #ìƒíƒœ í™•ì¸: offset 8, 9, 10ì´ ê°ê° ì½˜ì„¼íŠ¸ 1, 2, 3
 #ì œì–´ ë°©ì‹: ì¡°ëª…ê³¼ ë™ì¼í•˜ê²Œ ë‹¤ë¥¸ ì½˜ì„¼íŠ¸ ìƒíƒœë¥¼ ìœ ì§€í•˜ë©´ì„œ ì œì–´

 #ë‹¤ë¥¸ ë°©ì˜ ì½˜ì„¼íŠ¸ë¥¼ ì¶”ê°€í•˜ë ¤ë©´ 0x02 ë¶€ë¶„ë§Œ í•´ë‹¹ ë°© ë²ˆí˜¸ë¡œ ë³€ê²½í•˜ì‹œë©´ ë©ë‹ˆë‹¤:

 #ì•ˆë°©: 0x01
 #ì‚¬ë¼ë°©: 0x03
 #ì•ŒíŒŒë£¸: 0x04
 #ê±°ì‹¤: 0x00
 #ì£¼ë°©: 0x05
